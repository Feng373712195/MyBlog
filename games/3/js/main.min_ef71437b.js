var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}c((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){c.label=n[1];break}if(6===n[0]&&c.label<s[1]){c.label=s[1],s=n;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(n);break}s[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(r){n=[6,r],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},CommonScene=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.top=0,this.left=0,this.right=0,this.bottom=0},t.prototype.setBackBtn=function(e){var t=new eui.Image;t.source="back_png",t.width=97,t.height=86,t.top=38,this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e&&e(),SceneManager.getInstance().popScene()},this)},t}(eui.Component);__reflect(CommonScene.prototype,"CommonScene",["eui.UIComponent","egret.DisplayObject"]);var MessageBox=function(e){function t(){var t=e.call(this)||this;return t.event={},t}return __extends(t,e),t.prototype.childrenCreated=function(){this.messagebox.alpha=0,this.messagebox.scaleX=0,this.messagebox.scaleY=0,this.messagebox.y=document.body.clientHeight,this.messagebox.x=document.body.clientWidth,this.messagebox.anchorOffsetX=.5*this.messagebox.width,this.messagebox.anchorOffsetY=.5*this.messagebox.height,e.prototype.childrenCreated.call(this),this.setBackground(),this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeMessage,this)},t.prototype.setBackground=function(){var e=this.messagebox,t=e.width,n=e.height,r=new eui.Image;r.width=t+20,r.height=n+20,r.x=-10,r.y=-10,r.source="message_bg_png",this.bg.addChild(r)},t.prototype.showMessage=function(){var e=this;return SceneManager.getInstance().pushScene(this),new Promise(function(t){var n=egret.Tween.get(e.messagebox);n.to({alpha:1,scaleX:1,scaleY:1},200,egret.Ease.quartIn).call(function(){return e.emit("onShow")}).call(t)})},t.prototype.closeMessage=function(){var e=this;return new Promise(function(t){var n=egret.Tween.get(e.messagebox);n.to({alpha:0,scaleX:0,scaleY:0},200,egret.Ease.quartOut).call(function(){return e.emit("onClose")}).call(function(){return SceneManager.getInstance().popScene()}).call(t)})},t.prototype.on=function(e,t){this.event[e]||(this.event[e]=[]),this.event[e].push(t)},t.prototype.once=function(e,t){var n=this;this.event[e]||(this.event[e]=[]);var r=function(){t(),n.off(e,r)};this.event[e].push(r)},t.prototype.emit=function(e){this.event[e]&&this.event[e].forEach(function(e){return e()})},t.prototype.off=function(e,t){if(this.event[e]){var n=this.event[e].indexOf(t);this.event[e].splice(n,1)}},t}(eui.Component);__reflect(MessageBox.prototype,"MessageBox",["eui.UIComponent","egret.DisplayObject"]);var PkResultScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackground()},t.prototype.setBackground=function(){var e=750,t=1334,n=new egret.Shape,r=new egret.Matrix;r.createGradientBox(e,t,.5*Math.PI,0,0),n.graphics.beginGradientFill(egret.GradientType.LINEAR,[1495507,7534278],[1,1],[0,255],r),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),this.bg.addChild(n)},t}(eui.Component);__reflect(PkResultScene.prototype,"PkResultScene",["eui.UIComponent","egret.DisplayObject"]);var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function i(e){t.call(r,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var a=e.split("/");a.pop();var c=a.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(c,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Http;!function(e){function t(e){void 0===e&&(e={});var t=Object.keys(e),n=t.reduce(function(t,n){return t+="&"+n+"="+e[n]},"").slice(1);return n}function n(e,n,r,i,o){var s=this;return void 0===n&&(n={}),void 0===i&&(i=!1),void 0===o&&(o=!0),new Promise(function(r,i){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open("//httpbin.org"+e,egret.HttpMethod.POST),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");Object.keys(n);o&&(n.token=egret.localStorage.getItem("token"));var c=t(n);a.send(c),a.addEventListener(egret.Event.COMPLETE,function(e){r(e)},s),a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){i(e)},s)})}function r(e){var t=this;return new Promise(function(n,r){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open("//httpbin.org"+e,egret.HttpMethod.GET),i.send(),i.addEventListener(egret.Event.COMPLETE,function(e){n(e)},t),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){r(e)},t)})}e.PostRequest=n,e.GetRequest=r}(Http||(Http={}));var SceneManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scenes=[],t}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.changeScene=function(e){this.scenes.length?(this.popScene(),this.pushScene(e)):this.pushScene(e)},t.prototype.pushScene=function(e){this.scenes.push(e),this.rootLayer.addChild(e)},t.prototype.popScene=function(){var e=this.scenes.pop();this.rootLayer.removeChild(e)},t}(eui.Component);__reflect(SceneManager.prototype,"SceneManager");var SoundManager=function(){function e(){this.loadSound()}return e.getInstance=function(){return e.shared||(e.shared=new e),e.shared},e.prototype.loadSound=function(){},e}();__reflect(SoundManager.prototype,"SoundManager");var Timeout=function(){function e(){}return e.restTimeout=function(t){clearTimeout(e.timer),e.time=12,t.text=e.time+"S"},e.startTimeOut=function(t,n,r){e.timer=setTimeout(function(){if(0!==e.time){if(t.text=--e.time+"S",n(e.time),0===e.time)return void(r&&r());e.startTimeOut(t,n,r)}},1e3)},e.stopTimeOut=function(){clearTimeout(e.timer)},e.timer=null,e.time=12,e}();__reflect(Timeout.prototype,"Timeout");var User=function(){function e(){}return e.type=0,e.key=2,e}();__reflect(User.prototype,"User");var BeginScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0,this.start_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toStartScence.bind(this.start_btn,!1),this.start_btn),this.nologin_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toStartScence.bind(this.start_btn,!0),this.nologin_btn)},t.prototype.toStartScence=function(e){void 0===e&&(e=!1),e||(User.type=1),SceneManager.getInstance().changeScene(StartScene.getInstance())},t}(eui.Component);__reflect(BeginScene.prototype,"BeginScene",["eui.UIComponent","egret.DisplayObject"]);var ChooseTypeDetailScenen=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackBtn()},t}(CommonScene);__reflect(ChooseTypeDetailScenen.prototype,"ChooseTypeDetailScenen");var ChooseTypeScene=function(e){function t(){var t=e.call(this)||this;return t.sliderIndex=0,t}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackBtn(),this.type_btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toChooseTypeDetail,this),this.loopSlider()},t.prototype.loopSlider=function(){var e=this;if(4===this.sliderIndex){this.sliderIndex=0,egret.Tween.removeTweens(this.slider);var t=egret.Tween.get(this.slider);t.to({x:0},0),this.loopSlider()}else setTimeout(function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this["slider_btn"+(this.sliderIndex+1)].fillColor=0,++this.sliderIndex,this["slider_btn"+(4===this.sliderIndex?1:this.sliderIndex+1)].fillColor=16777215,[4,this.translateSlider(this.sliderIndex)];case 1:return e.sent(),this.loopSlider(),[2]}})})},1e3)},t.prototype.translateSlider=function(e){var t=this;return new Promise(function(n){console.log(e,"translateSlider",690*e);var r=egret.Tween.get(t.slider);r.to({x:-(690*e)},500).call(n)})},t.prototype.toChooseTypeDetail=function(){SceneManager.getInstance().pushScene(ChooseTypeDetailScenen.getInstance())},t}(CommonScene);__reflect(ChooseTypeScene.prototype,"ChooseTypeScene");var ANSWER_SELECT_COLORS=[14416106,16764364],ANSWER_RADIO_COLORS=[1300880,16732494,2342869],TIME_PPROGRESS_COLORS=[2342869,13365493],NUM_MAP={1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"},GAME_QUESTION_NUM=6,Tweens=[],GameScene=function(e){function t(){var t=e.call(this)||this;return t.question_answers=[],t.time_progress_block=[],t.current_quetion_index=1,t.player_selected=!1,t.isleave=!0,t}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.setBackBtn(function(){t.reset.bind(t)(0),t.isleave=!0}),this.init()},t.prototype.init=function(){this.initAnswerBtn(),this.resetGameScene(),this.usekey_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.useKey,this),this.time_progress_block=this.querySelector(this.time_progress,"time_progress_item",!0),this.time_progress_block=this.time_progress_block.reverse()},t.prototype.initAnswerBtn=function(){for(var e=1;4>=e;e++){var t=this["answer_"+e],n={btn:t,bg:this.querySelector(t,"question_bg"),radio:this.querySelector(t,"radio_box"),radio_checked:this.querySelector(t,"radio_checked"),icon:[this.querySelector(t,"right_icon"),this.querySelector(t,"error_icon")]};this.question_answers.push(n),n.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectAnswer.bind(this,e-1),n.btn),n.bg.alpha=0}},t.prototype.resetGameScene=function(){this.question_type.alpha=0,this.question_box.alpha=0,this.question_rule.alpha=0,this.question_answer.alpha=0},t.prototype.resetAnswerBtn=function(){this.question_answers.forEach(function(e,t){e.icon.forEach(function(e){return e.visible=!1}),e.radio.fillColor=ANSWER_RADIO_COLORS[2],e.radio_checked.alpha=0,e.bg.alpha=0})},t.prototype.resetTranstions=function(){this.transtions.visible&&(this.transtions.visible=!1)},t.prototype.resetTimeProgress=function(){this.time_progress_block.forEach(function(e){e.fillColor=TIME_PPROGRESS_COLORS[1]})},t.prototype.reset=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.current_quetion_index=e,egret.Tween.removeAllTweens(),this.resetTranstions(),[4,this.hideQuestion()];case 1:return t.sent(),Timeout.restTimeout(this.timeout),this.resetTimeProgress(),this.player_selected=!1,this.resetGameScene(),this.resetAnswerBtn(),this.question_index.text=e+"/"+GAME_QUESTION_NUM,[2]}})})},t.prototype.startGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.isleave=!1,[4,this.myPromise(this.reset(1))];case 1:return e.sent(),[4,this.myPromise(this.showTranstions("开始"))];case 2:return e.sent(),[4,this.myPromise(this.showQuestion())];case 3:return e.sent(),Timeout.startTimeOut(this.timeout,this.onTiemout.bind(this),this.timeoutHandle.bind(this)),[2]}})})},t.prototype.showTranstions=function(e){var t=this;this.transtions.text=e,this.transtions.visible=!0;var n=this.myTween(this.transtions);return new Promise(function(e){n.to({size:60},500,egret.Ease.backInOut).to({alpha:0},500,egret.Ease.backInOut).call(function(){t.transtions.size=40,t.transtions.alpha=1,t.transtions.visible=!1,e()})})},t.prototype.showQuestion=function(){var e=this;return new Promise(function(t){return __awaiter(e,void 0,void 0,function(){var e,n,r,i=this;return __generator(this,function(o){switch(o.label){case 0:e=[this.question_type,this.question_box,this.question_rule,this.question_answer],n=0,r=this.showQuestionAmin(e[n]),o.label=1;case 1:return n===e.length-1?[3,3]:[4,this.myPromise(r.then(function(){return r=i.showQuestionAmin(e[++n])}))];case 2:return o.sent(),[3,1];case 3:return t(),[2]}})})})},t.prototype.showQuestionAmin=function(e){var t=this,n=new Promise(function(n){var r=t.myTween(e);r.to({alpha:1},300,egret.Ease.circIn),r.call(function(){return n()})});return n},t.prototype.hideQuestion=function(){var e=this;return new Promise(function(t){var n=[e.question_type,e.question_box,e.question_rule,e.question_answer];n.forEach(function(t){e.myTween(t).to({alpha:0},500,egret.Ease.circOut)});var r=setTimeout(function(){t(),clearTimeout(r)},500)})},t.prototype.tapAnswerAmin=function(e){var t=this;return new Promise(function(n){var r=t.myTween(e.btn);r.to({scaleX:1.02,scaleY:1.02},200,egret.Ease.backInOut).to({scaleX:1,scaleY:1},200,egret.Ease.backInOut).call(n)})},t.prototype.showAnswerStateAmin=function(e,t){var n=this,r=0===t?0:1;return e.radio.fillColor=ANSWER_RADIO_COLORS[r],e.radio_checked.fillColor=ANSWER_RADIO_COLORS[r],e.bg.fillColor=ANSWER_SELECT_COLORS[r],e.icon[r].visible=!0,new Promise(function(t){var r=n.myTween(e.radio_checked);r.to({alpha:1},100,egret.Ease.backInOut);var i=n.myTween(e.bg);i.to({alpha:1},100,egret.Ease.circIn).call(t)})},t.prototype.errorAmin=function(){var e=this,t=this.game_window.x;return new Promise(function(n){var r=e.myTween(e.game_window);r.to({x:t-10},100,egret.Ease.cubicInOut).to({x:t+10},100,egret.Ease.cubicInOut).to({x:t-10},100,egret.Ease.cubicInOut).to({x:t},100,egret.Ease.cubicInOut).call(n)})},t.prototype.onTiemout=function(e){this.time_progress_block[e/3]&&(this.time_progress_block[e/3].fillColor=TIME_PPROGRESS_COLORS[0])},t.prototype.useKey=function(){var e=this;UseKeyMessageBox.getInstance().showMessage(),UseKeyMessageBox.getInstance().once("onClose",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return this.showNextQuestion(),[2]})})})},t.prototype.selectAnswer=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r=this;return __generator(this,function(i){switch(i.label){case 0:return this.player_selected?[2]:(this.player_selected=!0,t=this.question_answers[e],[4,this.tapAnswerAmin(t)]);case 1:return i.sent(),[4,this.checkAnswer(t,e)];case 2:return n=i.sent(),Timeout.stopTimeOut(),ResultMessageBox.getInstance().showMessage(),ResultMessageBox.getInstance().setSate(n),ResultMessageBox.getInstance().once("onClose",function(){return __awaiter(r,void 0,void 0,function(){return __generator(this,function(e){return this.showNextQuestion(),[2]})})}),[2]}})})},t.prototype.checkAnswer=function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:return n=0!==t?!1:!0,n?[3,2]:[4,this.errorAmin()];case 1:r.sent(),r.label=2;case 2:return[4,this.showAnswerStateAmin(e,t)];case 3:return r.sent(),[2,n]}})})},t.prototype.checkIsNext=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.showNextQuestion=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.current_quetion_index===GAME_QUESTION_NUM?(this.finishGame(),[2]):[4,this.myPromise(this.reset(this.current_quetion_index+1))];case 1:return e.sent(),[4,this.myPromise(this.showTranstions(this.current_quetion_index===GAME_QUESTION_NUM?"最后一题":"第"+NUM_MAP[this.current_quetion_index]+"题"))];case 2:return e.sent(),[4,this.myPromise(this.showQuestion())];case 3:return e.sent(),Timeout.startTimeOut(this.timeout,this.onTiemout.bind(this),this.timeoutHandle.bind(this)),[2]}})})},t.prototype.finishGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return Timeout.stopTimeOut(),[4,this.myPromise(this.hideQuestion())];case 1:return e.sent(),[4,this.myPromise(this.showTranstions("答题结束"))];case 2:return e.sent(),SceneManager.getInstance().changeScene(RankingResultScene.getInstance()),[2]}})})},t.prototype.timeoutHandle=function(){var e=this;ResultMessageBox.getInstance().showMessage(),ResultMessageBox.getInstance().setSate(0),ResultMessageBox.getInstance().once("onClose",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return this.showNextQuestion(),[2]})})})},t.prototype.querySelector=function(e,t,n){void 0===n&&(n=!1);var r=[],i=e.$children;if(!i.length)return n?[]:void 0;for(var o=0,s=i.length;s>o;o++){if(i[o].name===t){if(!n)return i[o];r.push(i[o])}if(i[o].$children&&i[o].$children.length){var a=this.querySelector(i[o],t);if(n)a.length&&r.push.apply(r,a);else if(a)return a}}return n?r:void 0},t.prototype.myPromise=function(e){var t=this;return new Promise(function(n,r){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return this.isleave&&r(),[4,e];case 1:return t=i.sent(),this.isleave&&r(),n(t),[2]}})})})},t.prototype.myTween=function(e){var t=egret.Tween.get(e);return t},t}(CommonScene);__reflect(GameScene.prototype,"GameScene");var NoKeyMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(MessageBox);__reflect(NoKeyMessageBox.prototype,"NoKeyMessageBox");var ResultMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.setSate=function(e){this.tip_text1.visible=e?!0:!1,this.tip_text2.visible=e?!1:!0},t}(MessageBox);__reflect(ResultMessageBox.prototype,"ResultMessageBox");var UseKeyMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(MessageBox);__reflect(UseKeyMessageBox.prototype,"UseKeyMessageBox");var PkGameScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);__reflect(PkGameScene.prototype,"PkGameScene",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/game_skins/Loading.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},t.prototype.createView=function(){},t.prototype.onProgress=function(e,t){var n=e/t;this.progress.value=100*n},t}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var PkScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackBtn(),this.setBackground(),this.pk_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showPkWait,this)},t.prototype.setBackground=function(){var e=this.stage.stageWidth,t=this.stage.stageHeight,n=new egret.Shape,r=new egret.Matrix;r.createGradientBox(e,t,.5*Math.PI,0,0),n.graphics.beginGradientFill(egret.GradientType.LINEAR,[1495507,7534278],[1,1],[0,255],r),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),this.bg.addChild(n)},t.prototype.showPkWait=function(){SceneManager.getInstance().pushScene(PkWaitMessageBox.getInstance()),PkWaitMessageBox.getInstance().showMessage()},t}(CommonScene);__reflect(PkScene.prototype,"PkScene");var PkWaitMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},t}(MessageBox);__reflect(PkWaitMessageBox.prototype,"PkWaitMessageBox");var RankingItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toGameScene,this)},t.prototype.dataChanged=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];2!==this.data.index?this.item_mask.visible=!0:this.item_mask.visible=!1,1==this.data.index&&(this.pass.visible=!0,this.nopass.visible=!1),this.data.index>2&&(this.nopass.visible=!0,this.pass.visible=!1)},t.prototype.toGameScene=function(){SceneManager.getInstance().pushScene(GameScene.getInstance()),GameScene.getInstance().startGame()},t}(eui.ItemRenderer);__reflect(RankingItem.prototype,"RankingItem");var RankingListScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackground(),this.setBackBtn(),this.loadRankingListView()},t.prototype.setBackground=function(){var e=this.stage.stageWidth,t=this.stage.stageHeight,n=new egret.Shape,r=new egret.Matrix;r.createGradientBox(e,t,.5*Math.PI,0,0),n.graphics.beginGradientFill(egret.GradientType.LINEAR,[1495507,7534278],[1,1],[0,255],r),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),this.bg.addChild(n)},t.prototype.getRankingData=function(e){return new Promise(function(t){for(var n=[],r=1;e>r;r++)n.push({index:r});setTimeout(function(){t(n)},0)})},t.prototype.loadRankingListView=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i;return __generator(this,function(o){switch(o.label){case 0:return e=this.ranking_view,[4,this.getRankingData(20)];case 1:return t=o.sent(),n=new eui.ArrayCollection(t),r=new eui.DataGroup,i=new eui.VerticalLayout,i.gap=30,r.layout=i,r.dataProvider=n,r.percentWidth=100,r.percentHeight=100,r.itemRenderer=RankingItem,r.useVirtualLayout=!0,e.viewport=r,[2]}})})},t}(CommonScene);__reflect(RankingListScene.prototype,"RankingListScene");var RankingResultScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackground(),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SceneManager.getInstance().changeScene(StartScene.getInstance())},this),this.play_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SceneManager.getInstance().changeScene(GameScene.getInstance()),GameScene.getInstance().startGame()},this)},t.prototype.setBackground=function(){var e=750,t=1334,n=new egret.Shape,r=new egret.Matrix;r.createGradientBox(e,t,.5*Math.PI,0,0),n.graphics.beginGradientFill(egret.GradientType.LINEAR,[1495507,7534278],[1,1],[0,255],r),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),this.bg.addChild(n)},t}(CommonScene);__reflect(RankingResultScene.prototype,"RankingResultScene");var RankItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.dataChanged=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.data.isloading&&(this.item_name_label.text="加载中"),1==this.data.rank&&(this.item_group.percentWidth=100),2==this.data.rank&&(this.item_group.percentWidth=98),3==this.data.rank&&(this.item_group.percentWidth=96),this.data.rank>3&&(this.item_group.percentWidth=94)},t}(eui.ItemRenderer);__reflect(RankItem.prototype,"RankItem");var RANKLIST_NUM=2,RankList=function(){function e(){this.list=[],this.data=null,this.load=!1}return e}();__reflect(RankList.prototype,"RankList",["RankList"]);var RankScene=function(e){function t(){var t=e.call(this)||this;return t.current_show_rank=null,t.rank1_list=new RankList,t.rank2_list=new RankList,t.isloading=!1,t}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){for(e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0,t=1;RANKLIST_NUM>=t;t++)this["rank"+t+"_btn"].addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectBtn.bind(this,t),this),this["rank"+t+"_view"].addEventListener(eui.UIEvent.CHANGE_END,this.pullDownLoad.bind(this,t),this);return this.loadRankListView(1),[2]})})},t.prototype.getRankData=function(e,t){return console.log("getRankData",t),new Promise(function(n){for(var r=[],i=1;e>i;i++)r.push({rank:i,name:t?t:"测试用户",score:1e3});setTimeout(function(){n(r)},0)})},t.prototype.loadRankListView=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return __generator(this,function(s){switch(s.label){case 0:return t=this["rank"+e+"_view"],n=this["rank"+e+"_list"],n.load?(this.setShowRankView(t,n.data,n.list),[2]):(this.showLoading(!0),[4,this.getRankData(20,e)]);case 1:return r=s.sent(),n.load=!0,i=new eui.ArrayCollection(r),n.data=i,o=new eui.DataGroup,o.dataProvider=i,o.percentWidth=100,o.percentHeight=100,o.itemRenderer=RankItem,o.useVirtualLayout=!0,n.list=o,this.showLoading(!1),this.setShowRankView(t,i,o),[2]}})})},t.prototype.setShowRankView=function(e,t,n){this.current_show_rank&&(this.current_show_rank.view.visible=!1),this.current_show_rank={view:e,data:t},this.current_show_rank.view.visible=!0,e.viewport=n},t.prototype.selectBtn=function(e){if(!this.isloading){var t=2==e?.48*this.tab_group.width:0,n=egret.Tween.get(this.select_btn);n.to({left:t},300,egret.Ease.quadIn).call(this.loadRankListView.bind(this,e))}},t.prototype.showLoading=function(e){this.current_show_rank&&(this.current_show_rank.view.visible=!1),this.isloading=e,this.loading.visible=e},t.prototype.pullDownLoad=function(e){var t=this["rank"+e+"_view"],n=t.viewport,r=n.scrollV,i=n.contentHeight,o=n.height;if(r+o===i){console.log("scroll bottom");var s=new eui.Label;s.text="加载中",this.current_show_rank.data.addItem({isloading:!0})}console.log("=== scroll end ===")},t}(eui.Component);__reflect(RankScene.prototype,"RankScene",["eui.UIComponent","egret.DisplayObject"]);var BuySuccessMessage=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(MessageBox);__reflect(BuySuccessMessage.prototype,"BuySuccessMessage");var ExchangeItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.exchange_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showExchangeMessage,this)},t.prototype.showExchangeMessage=function(){SceneManager.getInstance().pushScene(ExchangeSuccesMessage.getInstance()),ExchangeSuccesMessage.getInstance().showMessage()},t}(eui.ItemRenderer);__reflect(ExchangeItem.prototype,"ExchangeItem");var ExchangeSuccesMessage=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(MessageBox);__reflect(ExchangeSuccesMessage.prototype,"ExchangeSuccesMessage");var ShoppingItem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showBuyMessage,this)},t.prototype.showBuyMessage=function(){SceneManager.getInstance().pushScene(BuySuccessMessage.getInstance()),BuySuccessMessage.getInstance().showMessage()
},t}(eui.ItemRenderer);__reflect(ShoppingItem.prototype,"ShoppingItem");var SHOPPING_TAB_NUM=2,TAB_BTN_COLORS=[9588976,12094968],DataList=function(){function e(){this.list=[],this.data=null,this.load=!1}return e}();__reflect(DataList.prototype,"DataList",["DataList"]);var ShoppingMallScene=function(e){function t(){var t=e.call(this)||this;return t.current_show_tab=null,t.shopping1_list=new DataList,t.shopping2_list=new DataList,t.isloading=!1,t}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.setBackBtn(),this.setBackground();for(var t=1;SHOPPING_TAB_NUM>=t;t++)this["tab"+t+"_btn"].addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectBtn.bind(this,t),this);this.loadShoppingListView(1)},t.prototype.getShoppingListData=function(e,t){return console.log("getRankData",t),new Promise(function(n){for(var r=[],i=1;e>i;i++)r.push({rank:i,name:t?t:"测试用户",score:1e3});setTimeout(function(){n(r)},0)})},t.prototype.loadShoppingListView=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,s;return __generator(this,function(a){switch(a.label){case 0:return t=this["shopping"+e+"_view"],n=this["shopping"+e+"_list"],n.load?(this.setShowTabView(t,n.data,n.list,e),[2]):(r=[ShoppingItem,ExchangeItem],this.showLoading(!0),[4,this.getShoppingListData(20,e)]);case 1:return i=a.sent(),n.load=!0,o=new eui.ArrayCollection(i),n.data=o,s=new eui.DataGroup,s.dataProvider=o,s.percentWidth=100,s.percentHeight=100,s.itemRenderer=r[e-1],s.useVirtualLayout=!0,n.list=s,this.showLoading(!1),this.setShowTabView(t,o,s,e),[2]}})})},t.prototype.setShowTabView=function(e,t,n,r){this.current_show_tab&&(this.current_show_tab.view.visible=!1),this.current_show_tab={view:e,data:t,index:r},this.current_show_tab.view.visible=!0,e.viewport=n},t.prototype.selectBtn=function(e){if(!this.isloading){var t=this.current_show_tab.index;console.log(this["tab"+t+"_btn"].getChildAt(0),this["tab"+e+"_btn"].getChildAt(0)),this["tab"+t+"_btn"].getChildAt(0).fillColor=TAB_BTN_COLORS[1],this["tab"+e+"_btn"].getChildAt(0).fillColor=TAB_BTN_COLORS[0],this.loadShoppingListView(e)}},t.prototype.showLoading=function(e){this.current_show_tab&&(this.current_show_tab.view.visible=!1),this.isloading=e,this.loading.visible=e},t.prototype.setBackground=function(){var e=this.stage.stageWidth,t=this.stage.stageHeight,n=new egret.Shape,r=new egret.Matrix;r.createGradientBox(e,t,.5*Math.PI,0,0),n.graphics.beginGradientFill(egret.GradientType.LINEAR,[1495507,7534278],[1,1],[0,255],r),n.graphics.drawRect(0,0,e,t),n.graphics.endFill(),this.bg.addChild(n)},t}(CommonScene);__reflect(ShoppingMallScene.prototype,"ShoppingMallScene");var LevelUpMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},t}(MessageBox);__reflect(LevelUpMessageBox.prototype,"LevelUpMessageBox");var LoginInMessageBox=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},t}(MessageBox);__reflect(LoginInMessageBox.prototype,"LoginInMessageBox");var StartScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return t.shared||(t.shared=new t),t.shared},t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){0===User.type&&(this.menu_item_4.visible=!1,this.menu_warp.scrollPolicyV="off"),e.prototype.childrenCreated.call(this),LoginInMessageBox.getInstance().showMessage();var t=new eui.HorizontalLayout;t.horizontalAlign=egret.HorizontalAlign.JUSTIFY,this.bottom_nav.layout=t,this.menu_item_1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toRankingList,this),this.menu_item_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toPK,this),this.menu_item_3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toYB,this),this.bottom_nav_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toShoppingMail,this)},t.prototype.toRankingList=function(){SceneManager.getInstance().pushScene(RankingListScene.getInstance())},t.prototype.toYB=function(){SceneManager.getInstance().pushScene(ChooseTypeScene.getInstance())},t.prototype.toPK=function(){SceneManager.getInstance().pushScene(PkScene.getInstance())},t.prototype.toShoppingMail=function(){SceneManager.getInstance().pushScene(ShoppingMallScene.getInstance())},t}(CommonScene);__reflect(StartScene.prototype,"StartScene");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?r(i):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=n.sent(),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return t=n.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),e=new LoadingUI,this.addChild(e),[4,RES.loadGroup("preload",0,e)];case 3:return n.sent(),this.removeChild(e),[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return SceneManager.getInstance().rootLayer=this,SceneManager.getInstance().changeScene(StartScene.getInstance()),[2]})})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var WxSDK=function(){function e(){var e=new BodyConfig;e.appId="此处填写公共平台appID，未认证的ID将不能使用自定义分享等接口，请联系微信官方获取",e.debug=!0,e.jsApiList=["checkJsApi","onMenuShareAppMessage","onMenuShareTimeline"],wx&&(wx.config(e),wx.ready(function(){var e="",t="",n=location.href,r=new BodyMenuShareAppMessage;r.title=e,r.desc=t,r.link=n,wx.onMenuShareTimeline(r);var i=new BodyMenuShareTimeline;i.title=e,i.link=n,wx.onMenuShareTimeline(i)}))}return e.prototype.getWxConfig=function(){},e}();__reflect(WxSDK.prototype,"WxSDK");