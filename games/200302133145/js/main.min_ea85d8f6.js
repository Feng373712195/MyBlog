var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i["throw"](e))}catch(t){a(t)}}function c(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(o,s)}c((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return i([e,t])}}function i(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(o=a[2&r[0]?"return":r[0]?"throw":"next"])&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[0,o.value]),r[0]){case 0:case 1:o=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,a=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){c.label=r[1];break}if(6===r[0]&&c.label<o[1]){c.label=o[1],o=r;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(r);break}o[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(i){r=[6,i],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function i(i){t.call(r,i,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?i(n):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(){this.drawGame()},t.prototype.drawGame=function(){var e=new Menu(this.stage.stageWidth,this.stage.stageHeight),t=new Game(this.stage.stageWidth,this.stage.stageHeight),r=e.draw(),i=t.draw(),n=new egret.Event("startGame"),a=new egret.Event("changeHistory"),o=this;o.addChild(r);var s=new egret.Sprite;s.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight);var c=new egret.TextField;c.textColor=0,c.text="START",c.size=50,s.addChild(c),c.width=this.stage.stageWidth,c.height=this.stage.stageHeight,c.textAlign=egret.HorizontalAlign.CENTER,c.verticalAlign=egret.VerticalAlign.MIDDLE,r.addEventListener("startGame",function(){o.removeChild(r),o.addChild(s);var e=egret.Tween.get(c);e.to({size:100},500,egret.Ease.circIn).wait(200).call(function(){o.removeChild(s),i.dispatchEvent(n),o.addChild(i)}).to({size:50},500,egret.Ease.circIn)},r),i.addEventListener("gameOver",function(){console.log("game Over Event"),r.dispatchEvent(a)},i),i.addEventListener("backMenu",function(){o.removeChild(i),o.addChild(r)},i)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,i){function n(e){t.call(i,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),r.call(i))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,r){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(i,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(i,generateJSON.paths[e])},this):RES.getResByUrl(c,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){t.call(i,generateJSON.paths[e])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var BREAS_NUM=40,BREAS_Y=30,Bread=function(e){function t(t){var r=e.call(this)||this;return r.faceX=0,r.faceY=0,r.breas=[],r.touchBreadCb=function(){},r.removeBear=function(e){return new Promise(function(t){e.touchEnabled=!1;var i=egret.Tween.get(e);i.to({y:50},500).call(function(){var i=r.breas.indexOf(e);egret.Tween.removeTweens(e),e.removeEventListener(egret.TouchEvent.TOUCH_TAP,r.touchBear,e),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,r.touchBear,e),e.parent.removeChild(e),r.breas.splice(i,1),e=null,t()})})},r.touchBear=function(e,t,i){return __awaiter(r,void 0,void 0,function(){var r,i=this;return __generator(this,function(n){switch(n.label){case 0:return this.breas.length<=30&&(r=setTimeout(function(){for(var e=0;++e<10;)i.createBear(t);clearTimeout(r)})),e.parent?(this.touchBreadCb(),[4,this.removeBear(e)]):[3,2];case 1:n.sent(),this.createBear(t),n.label=2;case 2:return[2]}})})},r.faceX=t.faceX,r.faceY=t.faceY,r.touchBreadCb&&(r.touchBreadCb=t.touchBreadCb),r}return __extends(t,e),t.prototype.draw=function(e){var t=new egret.Sprite;t.graphics.beginFill(16119285),t.graphics.drawArc(this.faceX,2*this.faceY,250,0,Math.PI,!0),t.graphics.endFill(),t.scaleY=.5,e.addChild(t);var r=new egret.Sprite;r.graphics.beginFill(16119285),r.graphics.drawArc(this.faceX,this.faceY-2,250,0,Math.PI,!1),r.graphics.endFill(),this.drawBears(r),e.addChild(r)},t.prototype.randPoint=function(e,t,r,i){void 0===i&&(i=0);var n=2*Math.PI*Math.random(),a=Math.sqrt(Math.random())*e,o=t+a*Math.cos(n),s=r+a*Math.sin(n);return s<this.faceY-BREAS_Y&&3!=i?this.randPoint(e,t,r,++i):[o,s]},t.prototype.drawBear=function(e,t,r){var i=new egret.Sprite;i.graphics.beginFill(0,0),i.graphics.drawCircle(e>=this.faceX?e-20:e-10,t-25,50);var n=new egret.Shape;return n.graphics.lineStyle(2,0),n.graphics.moveTo(e,t),n.graphics.lineTo(e>=this.faceX?e-10:e+10,t-20),n.graphics.endFill(),i.zIndex=99,i.addChild(n),i.graphics.endFill(),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchBear.bind(this,i,r),i),i.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchBear.bind(this,i,r),i),i},t.prototype.createBear=function(e){var t=this.randPoint(250,this.faceX,this.faceY),r=t[0],i=t[1];if(i>this.faceY-BREAS_Y){var n=this.drawBear(r,i,e);this.breas.push(n),e.addChild(n)}},t.prototype.drawBears=function(e){for(var t=0;BREAS_NUM>t;t++)this.createBear(e)},t}(egret.Sprite);__reflect(Bread.prototype,"Bread",["BreadInterface"]);var Face=function(e){function t(t){var r=e.call(this)||this;return r.faceX=0,r.faceY=0,r.faceX=t.x,r.faceY=t.y,r}return __extends(t,e),t.prototype.draw=function(){var e=this,t=this.drawFace(),r=this.drawOpenMouth();this.openMouthAction=this.openMouthAction.bind(this,t,r);var i=new egret.Event("touchBread"),n=new Bread({faceX:this.faceX,faceY:this.faceY,touchBreadCb:function(){t.dispatchEvent(i),e.openMouthAction()}});return n.draw(t),this.drawEyes(t),this.drawMouth(t),t.touchEnabled=!0,t},t.prototype.drawEyes=function(e){for(var t=0;2>t;t++){var r=new egret.Sprite,i=new egret.Sprite;r.graphics.lineStyle(2,0),r.graphics.drawArc(this.faceX-37.5+150*t/2,this.faceY-200,10,0,Math.PI,!1),r.graphics.endFill(),e.addChild(r),i.graphics.beginFill(0),i.graphics.drawCircle(this.faceX-75+150*t,this.faceY-150,10),i.graphics.endFill(),e.addChild(i)}},t.prototype.drawMouth=function(e){var t=new egret.Sprite;t.graphics.lineStyle(2,0),t.graphics.drawArc(this.faceX,this.faceY-100,20,0,Math.PI,!0),t.graphics.endFill(),e.addChild(t)},t.prototype.drawOpenMouth=function(){var e=new egret.Sprite;return e.graphics.lineStyle(2,0),e.graphics.beginFill(267386880),e.graphics.drawCircle(this.faceX,this.faceY-100,20),e.graphics.endFill(),e},t.prototype.drawFace=function(){var e=new egret.Sprite;return e.graphics.lineStyle(2,0),e.graphics.beginFill(16777215),e.graphics.drawCircle(this.faceX,this.faceY,250),e.graphics.endFill(),e.touchEnabled=!0,e},t.prototype.openMouthAction=function(e,t){e.addChild(t);var r=setTimeout(function(){t.parent&&t.parent.removeChild(t),clearTimeout(r)},300)},t}(egret.Sprite);__reflect(Face.prototype,"Face",["FaceInterface"]);var GAME_TIME_SECOUND=10,GAME_STORAGE_NAME="wuzefeng_game01_recode",Game=function(e){function t(t,r){var i=e.call(this)||this;return i.playing=!0,i.gameTime=GAME_TIME_SECOUND,i.firstPlay=!0,i.stageW=t,i.stageH=r,i}return __extends(t,e),t.prototype.draw=function(){var e=this;this.playing=!0;var t=new egret.Event("backMenu"),r=new egret.Event("restart"),i=new egret.Event("gameOver"),n=this.drawResultView({backMenuCb:function(){return a.dispatchEvent(t)},restartCb:function(){return a.dispatchEvent(r)}}),a=new egret.Sprite;a.graphics.drawRect(0,0,this.stageW,this.stageH),a.graphics.endFill();var o=new Face({x:this.stageW/2,y:this.stageH/2,width:0,height:0}),s=o.draw(),c=new egret.TextField;c.size=30,c.textColor=0,c.text="back",a.addChild(c),c.y=40,c.x=80,c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){a.dispatchEvent(t)},c);var l=new egret.TextField;l.size=60,l.text=GAME_TIME_SECOUND+"",l.textColor=0,a.addChild(l),l.y=this.stageH/2-400,l.width=this.stageW,l.textAlign=egret.HorizontalAlign.CENTER;var h=function(t){setTimeout(function(){if(0!==e.gameTime){if(l.text=--e.gameTime+"",0===e.gameTime)return void t();h(t)}},1e3)},d=function(){e.playing=!1,a.dispatchEvent(i)};a.addEventListener("startGame",function(){return e.firstPlay?(h(d),void(e.firstPlay=!1)):void a.dispatchEvent(r)},a);var g=0,u=new egret.TextField;return u.size=30,u.textColor=0,u.text="得分："+g,a.addChild(u),u.y=40,u.x=this.stageW-200,s.addEventListener("touchBread",function(){e.playing&&(u.text="得分："+ ++g)},s),a.addEventListener("gameOver",function(){n.changeScore(g),a.addChild(n.view);var e=egret.localStorage.getItem(GAME_STORAGE_NAME);e?Number(g)>Number(e)&&egret.localStorage.setItem(GAME_STORAGE_NAME,g+""):egret.localStorage.setItem(GAME_STORAGE_NAME,g+"")},a),a.addEventListener("restart",function(){e.gameTime=GAME_TIME_SECOUND,g=0,u.text="得分："+g,l.text=e.gameTime+"",h(d),n.changeScore(0),e.playing=!0,n.view.parent&&n.view.parent.removeChild(n.view)},a),a.addChild(s),a},t.prototype.drawResultView=function(e){var t=this,r=e.restartCb,i=e.backMenuCb,n=new egret.Sprite;n.zIndex=999,n.graphics.beginFill(0,.4),n.graphics.drawRect(0,0,this.stageW,this.stageH),n.graphics.endFill();var a=new egret.Sprite;a.graphics.lineStyle(5,0),a.graphics.beginFill(16777215),a.graphics.drawRoundRect(0,0,500,500,20,20),a.x=this.stageW/2-250,a.y=this.stageH/2-250,a.graphics.endFill();var o=new egret.TextField;o.textColor=0,o.size=45,o.text="时间到～";var s=new egret.TextField;s.textColor=0,s.text="你的得分是：",s.size=35;var c=new egret.TextField;c.text="重新开始",c.size=30,c.textColor=0,c.touchEnabled=!0;var l=new egret.TextField;return l.text="返回菜单",l.size=30,l.textColor=0,l.touchEnabled=!0,a.addChild(c),a.addChild(l),a.addChild(o),a.addChild(s),o.width=500,o.y=40,o.textAlign=egret.HorizontalAlign.CENTER,s.width=500,s.y=120,s.textAlign=egret.HorizontalAlign.CENTER,c.width=500,c.y=300,c.textAlign=egret.HorizontalAlign.CENTER,c.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r&&r.bind(t)()},c),l.width=500,l.y=380,l.textAlign=egret.HorizontalAlign.CENTER,l.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i&&i.bind(t)()},l),n.addChild(a),{view:n,changeScore:function(e){s.text="你的得分是："+e}}},t}(egret.Sprite);__reflect(Game.prototype,"Game",["GameInterface"]);var Menu=function(e){function t(t,r){var i=e.call(this)||this;return i.stageW=t,i.stageH=r,i}return __extends(t,e),t.prototype.draw=function(){var e=new egret.Sprite;e.graphics.drawRect(0,0,this.stageW,this.stageH),e.graphics.endFill();var t=new egret.TextField;t.textColor=0,t.size=80,e.addChild(t),t.width=this.stageW,t.height=this.stageH,t.text="剃胡子",t.textAlign=egret.HorizontalAlign.CENTER,t.anchorOffsetX=this.stageW/2,t.x=this.stageW/2,t.y=this.stageH/10*3;var r=egret.Tween.get(t,{loop:!0});this.gameNameAnim(r);var i=new egret.Sprite;i.graphics.drawRect(0,0,400,400),i.x=this.stageW/2-200,i.y=this.stageH/2-200+200,i.graphics.endFill();var n=new egret.TextField;n.textColor=0,n.touchEnabled=!0,i.addChild(n),n.size=35,n.width=400,n.text="开始游戏",n.y=20,n.textAlign=egret.HorizontalAlign.CENTER,n.verticalAlign=egret.VerticalAlign.MIDDLE;var a=new egret.Event("startGame");n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.dispatchEvent(a)},n);var o=new egret.TextField;o.textColor=0,o.touchEnabled=!0,i.addChild(o),o.size=35,o.width=400,o.text="关于游戏",o.y=100,o.textAlign=egret.HorizontalAlign.CENTER,o.verticalAlign=egret.VerticalAlign.MIDDLE,e.addChild(i);var s=new egret.TextField;s.textColor=7372944,e.addChild(s),s.size=30,s.text="作者：低调哥",s.y=this.stageH/10*9,s.width=this.stageW,s.textAlign=egret.HorizontalAlign.CENTER,s.verticalAlign=egret.VerticalAlign.MIDDLE;var c=egret.localStorage.getItem(GAME_STORAGE_NAME),l=new egret.TextField;l.textColor=7372944,l.size=30,l.y=this.stageH/10*1,l.width=this.stageW,l.textAlign=egret.HorizontalAlign.CENTER,l.verticalAlign=egret.VerticalAlign.MIDDLE,c&&(l.text="最高纪录："+c,e.addChild(l)),e.addEventListener("changeHistory",function(){var t=egret.localStorage.getItem(GAME_STORAGE_NAME);l.text="最高纪录："+t,e.addChild(l)},e);var h=new egret.Sprite;h.graphics.lineStyle(5,0),h.graphics.beginFill(16777215),h.graphics.drawRoundRect(0,0,500,500,20,20),h.x=this.stageW/2-250,h.y=this.stageH/2-250,h.graphics.endFill();var d=new egret.Sprite;d.graphics.lineStyle(5,0),d.graphics.beginFill(16777215),d.graphics.drawCircle(0,0,30),d.x=500,d.graphics.endFill();var g=new egret.TextField;g.touchEnabled=!0,g.textColor=0,g.size=40,g.text="x",d.addChild(g),g.y=-25,g.x=-10;var u=new egret.TextField;u.textColor=0,u.size=42,u.text="关于游戏",h.addChild(u),u.y=40,u.width=500,u.textAlign=egret.HorizontalAlign.CENTER;var p=new egret.TextField;return p.textColor=0,p.size=32,p.text="瞧呐！！！快看看这个家伙，胡子长个不停。大家赶快来帮帮它。用手指划动或者点击脸部下巴的胡子，即可帮它拔掉，看看你们在规定的秒数内可以剃掉多少胡子。",h.addChild(p),p.lineSpacing=15,p.y=120,p.x=30,p.width=450,h.addChild(d),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.addChild(h)},o),d.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeChild(h)},o),e},t.prototype.gameNameAnim=function(e){e.to({rotation:10},999,egret.Ease.backInOut),e.to({rotation:-10},999,egret.Ease.backInOut).call(this.gameNameAnim.bind(this,e))},t}(egret.Sprite);__reflect(Menu.prototype,"Menu",["MenuInter"]);